<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Round5: shake.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Round5
   </div>
   <div id="projectbrief">Implementation of Round5 (reference version)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">shake.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="shake_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2018, Koninklijke Philips N.V.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifndef _SHAKE_H_</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#define _SHAKE_H_</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="misc_8h.html">misc.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;libkeccak.a.headers/KeccakHash.h&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;libkeccak.a.headers/SP800-185.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifdef DOXYGEN</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* Document SHAKE implementation option macro */</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="shake_8h.html#a54cc4409bb64b30bc97df9b95ad30fcd">   35</a></span>&#160;<span class="preprocessor">#define NO_OPENSSL_SHAKE</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">   38</a></span>&#160;<span class="keyword">typedef</span> Keccak_HashInstance <a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a>; </div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">   39</a></span>&#160;<span class="keyword">typedef</span> cSHAKE_Instance <a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a>; </div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="shake_8h.html#a049b154b3d12b0df19b2c986f458341d">   44</a></span>&#160;<span class="preprocessor">#define SHAKE128_RATE 168</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="shake_8h.html#a8cd7a41f6f7efca80d063e7521f5b7fa">   49</a></span>&#160;<span class="preprocessor">#define SHAKE256_RATE 136</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="shake_8h.html#af38b8a7c1bfbc3facbfaa527bd7d920e">   60</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#af38b8a7c1bfbc3facbfaa527bd7d920e">shake128_init</a>(<a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashInitialize_SHAKE128(ctx) != 0) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to initialize SHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            abort();</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="shake_8h.html#a2d3a88aa2f1132184acf85332f216764">   74</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a2d3a88aa2f1132184acf85332f216764">shake128_absorb</a>(<a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashUpdate(ctx, input, input_len * 8) != 0) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to update SHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            abort();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashFinal(ctx, NULL) != 0) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to finalize SHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            abort();</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="shake_8h.html#a5d95194ec13b430cc983d86f62f6a782">   94</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a5d95194ec13b430cc983d86f62f6a782">shake128_squeezeblocks</a>(<a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keyword">const</span> <span class="keywordtype">size_t</span> nr_blocks) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashSqueeze(ctx, output, nr_blocks * <a class="code" href="shake_8h.html#a049b154b3d12b0df19b2c986f458341d">SHAKE128_RATE</a> * 8) != 0) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to squeeze SHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            abort();</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a6af422fd8ded87bf62ec731c2e8c3b67">shake128</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keywordtype">size_t</span> output_len, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="shake_8h.html#a196b92593cc22d7ad0748ceaa9c576de">  115</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a196b92593cc22d7ad0748ceaa9c576de">shake256_init</a>(<a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashInitialize_SHAKE256(ctx) != 0) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to initialize SHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            abort();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="shake_8h.html#a621bd1b10103c1ced7fa0fbd98dc4ba9">  129</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a621bd1b10103c1ced7fa0fbd98dc4ba9">shake256_absorb</a>(<a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashUpdate(ctx, input, input_len * 8) != 0) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to update SHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            abort();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashFinal(ctx, NULL) != 0) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to finalize SHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            abort();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="shake_8h.html#a2bbe14efcaf6001322c9cc7113a55e35">  149</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a2bbe14efcaf6001322c9cc7113a55e35">shake256_squeezeblocks</a>(<a class="code" href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keyword">const</span> <span class="keywordtype">size_t</span> nr_blocks) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (Keccak_HashSqueeze(ctx, output, nr_blocks * <a class="code" href="shake_8h.html#a8cd7a41f6f7efca80d063e7521f5b7fa">SHAKE256_RATE</a> * 8) != 0) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to squeeze SHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            abort();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a5dfb3ef153896df11536d0f05b541b7a">shake256</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keyword">const</span> <span class="keywordtype">size_t</span> output_len, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="shake_8h.html#aa5c39b537f89f69b2055de148f21e8b6">  172</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#aa5c39b537f89f69b2055de148f21e8b6">cshake128_init</a>(<a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *customization, <span class="keyword">const</span> <span class="keywordtype">size_t</span> customization_len) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span> (cSHAKE128_Initialize(ctx, 0, NULL, 0, customization, customization_len * 8) != 0) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to initialize cSHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            abort();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="shake_8h.html#a78bd7ec5e7ff7680536e2802363dba75">  186</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a78bd7ec5e7ff7680536e2802363dba75">cshake128_absorb</a>(<a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> (cSHAKE128_Update(ctx, input, input_len * 8) != 0) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to update cSHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            abort();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">if</span> (cSHAKE128_Final(ctx, NULL) != 0) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to finalize cSHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            abort();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="shake_8h.html#affe2c60901d7e966387992cc13d0c67b">  206</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#affe2c60901d7e966387992cc13d0c67b">cshake128_squeezeblocks</a>(<a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keyword">const</span> <span class="keywordtype">size_t</span> nr_blocks) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (cSHAKE128_Squeeze(ctx, output, nr_blocks * <a class="code" href="shake_8h.html#a049b154b3d12b0df19b2c986f458341d">SHAKE128_RATE</a> * 8) != 0) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to squeeze cSHAKE128 context\n&quot;</span>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            abort();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="shake_8h.html#ad39f37614bd6efded56dd11037d481d3">  222</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#ad39f37614bd6efded56dd11037d481d3">cshake128</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keywordtype">size_t</span> output_len, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *customization, <span class="keyword">const</span> <span class="keywordtype">size_t</span> customization_len) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span> (cSHAKE128(input, input_len * 8, output, output_len * 8, NULL, 0, customization, customization_len) != 0) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to perform cSHAKE128\n&quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            abort();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="shake_8h.html#ab45f1025ada0d380abc86034a04b0250">  236</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#ab45f1025ada0d380abc86034a04b0250">cshake256_init</a>(<a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *customization, <span class="keyword">const</span> <span class="keywordtype">size_t</span> customization_len) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> (cSHAKE256_Initialize(ctx, 0, NULL, 0, customization, customization_len * 8) != 0) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to initialize cSHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            abort();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="shake_8h.html#a5c9045c5f7d76c00c96db8a202b0dd18">  250</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a5c9045c5f7d76c00c96db8a202b0dd18">cshake256_absorb</a>(<a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (cSHAKE256_Update(ctx, input, input_len * 8) != 0) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to update cSHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            abort();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (cSHAKE256_Final(ctx, NULL) != 0) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to finalize cSHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            abort();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="shake_8h.html#a9f1691852cdc09330dd68e006481223f">  270</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a9f1691852cdc09330dd68e006481223f">cshake256_squeezeblocks</a>(<a class="code" href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a> *<a class="code" href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keyword">const</span> <span class="keywordtype">size_t</span> nr_blocks) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> (cSHAKE256_Squeeze(ctx, output, nr_blocks * <a class="code" href="shake_8h.html#a8cd7a41f6f7efca80d063e7521f5b7fa">SHAKE256_RATE</a> * 8) != 0) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to squeeze cSHAKE256 context\n&quot;</span>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            abort();</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="shake_8h.html#a0acf5af5ab808883a94943eec7182ee1">  286</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="shake_8h.html#a0acf5af5ab808883a94943eec7182ee1">cshake256</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *output, <span class="keywordtype">size_t</span> output_len, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *input, <span class="keyword">const</span> <span class="keywordtype">size_t</span> input_len, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *customization, <span class="keyword">const</span> <span class="keywordtype">size_t</span> customization_len) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (cSHAKE256(input, input_len * 8, output, output_len * 8, NULL, 0, customization, customization_len) != 0) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a>(<span class="stringliteral">&quot;Error: Failed to perform cSHAKE128\n&quot;</span>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            abort();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SHAKE_H */</span><span class="preprocessor"></span></div><div class="ttc" id="shake_8h_html_a78bd7ec5e7ff7680536e2802363dba75"><div class="ttname"><a href="shake_8h.html#a78bd7ec5e7ff7680536e2802363dba75">cshake128_absorb</a></div><div class="ttdeci">void cshake128_absorb(cshake_ctx *ctx, const unsigned char *input, const size_t input_len)</div><div class="ttdoc">Performs the absorb step of the cSHAKE-128 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:186</div></div>
<div class="ttc" id="shake_8h_html_a9f1691852cdc09330dd68e006481223f"><div class="ttname"><a href="shake_8h.html#a9f1691852cdc09330dd68e006481223f">cshake256_squeezeblocks</a></div><div class="ttdeci">void cshake256_squeezeblocks(cshake_ctx *ctx, unsigned char *output, const size_t nr_blocks)</div><div class="ttdoc">Performs the squeeze step of the cSHAKE-256 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:270</div></div>
<div class="ttc" id="misc_8h_html_a1113e83492a11aaddbea24646cf378ed"><div class="ttname"><a href="misc_8h.html#a1113e83492a11aaddbea24646cf378ed">DEBUG_ERROR</a></div><div class="ttdeci">#define DEBUG_ERROR(...)</div><div class="ttdoc">Macro for printing errors. </div><div class="ttdef"><b>Definition:</b> misc.h:47</div></div>
<div class="ttc" id="shake_8h_html_a2bbe14efcaf6001322c9cc7113a55e35"><div class="ttname"><a href="shake_8h.html#a2bbe14efcaf6001322c9cc7113a55e35">shake256_squeezeblocks</a></div><div class="ttdeci">void shake256_squeezeblocks(shake_ctx *ctx, unsigned char *output, const size_t nr_blocks)</div><div class="ttdoc">Performs the squeeze step of the SHAKE-256 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:149</div></div>
<div class="ttc" id="misc_8h_html"><div class="ttname"><a href="misc_8h.html">misc.h</a></div><div class="ttdoc">Declaration of miscellaneous macros and functions. </div></div>
<div class="ttc" id="drbg_8c_html_a070d8852339c0f09fc03d7ed99935cc6"><div class="ttname"><a href="drbg_8c.html#a070d8852339c0f09fc03d7ed99935cc6">ctx</a></div><div class="ttdeci">static drbg_ctx ctx</div><div class="ttdoc">The context for the DRBG. </div><div class="ttdef"><b>Definition:</b> drbg.c:104</div></div>
<div class="ttc" id="shake_8h_html_a196b92593cc22d7ad0748ceaa9c576de"><div class="ttname"><a href="shake_8h.html#a196b92593cc22d7ad0748ceaa9c576de">shake256_init</a></div><div class="ttdeci">void shake256_init(shake_ctx *ctx)</div><div class="ttdoc">Performs the initialisation step of the SHAKE-256 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:115</div></div>
<div class="ttc" id="shake_8h_html_af38b8a7c1bfbc3facbfaa527bd7d920e"><div class="ttname"><a href="shake_8h.html#af38b8a7c1bfbc3facbfaa527bd7d920e">shake128_init</a></div><div class="ttdeci">void shake128_init(shake_ctx *ctx)</div><div class="ttdoc">Performs the initialisation step of the SHAKE-128 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:60</div></div>
<div class="ttc" id="shake_8h_html_affe2c60901d7e966387992cc13d0c67b"><div class="ttname"><a href="shake_8h.html#affe2c60901d7e966387992cc13d0c67b">cshake128_squeezeblocks</a></div><div class="ttdeci">void cshake128_squeezeblocks(cshake_ctx *ctx, unsigned char *output, const size_t nr_blocks)</div><div class="ttdoc">Performs the squeeze step of the cSHAKE-128 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:206</div></div>
<div class="ttc" id="shake_8h_html_af002bd9ed29da8eea5c69f62f5b1f581"><div class="ttname"><a href="shake_8h.html#af002bd9ed29da8eea5c69f62f5b1f581">cshake_ctx</a></div><div class="ttdeci">cSHAKE_Instance cshake_ctx</div><div class="ttdoc">The cshake context (state) </div><div class="ttdef"><b>Definition:</b> shake.h:39</div></div>
<div class="ttc" id="shake_8h_html_a6af422fd8ded87bf62ec731c2e8c3b67"><div class="ttname"><a href="shake_8h.html#a6af422fd8ded87bf62ec731c2e8c3b67">shake128</a></div><div class="ttdeci">void shake128(unsigned char *output, size_t output_len, const unsigned char *input, const size_t input_len)</div><div class="ttdoc">Performs the full SHAKE-128 XOF to the given input. </div><div class="ttdef"><b>Definition:</b> shake.c:33</div></div>
<div class="ttc" id="shake_8h_html_ad39f37614bd6efded56dd11037d481d3"><div class="ttname"><a href="shake_8h.html#ad39f37614bd6efded56dd11037d481d3">cshake128</a></div><div class="ttdeci">void cshake128(unsigned char *output, size_t output_len, const unsigned char *input, const size_t input_len, const unsigned char *customization, const size_t customization_len)</div><div class="ttdoc">Performs the full cSHAKE-128 XOF to the given input. </div><div class="ttdef"><b>Definition:</b> shake.h:222</div></div>
<div class="ttc" id="shake_8h_html_a5dfb3ef153896df11536d0f05b541b7a"><div class="ttname"><a href="shake_8h.html#a5dfb3ef153896df11536d0f05b541b7a">shake256</a></div><div class="ttdeci">void shake256(unsigned char *output, const size_t output_len, const unsigned char *input, const size_t input_len)</div><div class="ttdoc">Performs the full SHAKE-256 XOF to the given input. </div><div class="ttdef"><b>Definition:</b> shake.c:68</div></div>
<div class="ttc" id="shake_8h_html_a2d3a88aa2f1132184acf85332f216764"><div class="ttname"><a href="shake_8h.html#a2d3a88aa2f1132184acf85332f216764">shake128_absorb</a></div><div class="ttdeci">void shake128_absorb(shake_ctx *ctx, const unsigned char *input, const size_t input_len)</div><div class="ttdoc">Performs the absorb step of the SHAKE-128 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:74</div></div>
<div class="ttc" id="shake_8h_html_a5c9045c5f7d76c00c96db8a202b0dd18"><div class="ttname"><a href="shake_8h.html#a5c9045c5f7d76c00c96db8a202b0dd18">cshake256_absorb</a></div><div class="ttdeci">void cshake256_absorb(cshake_ctx *ctx, const unsigned char *input, const size_t input_len)</div><div class="ttdoc">Performs the absorb step of the cSHAKE-256 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:250</div></div>
<div class="ttc" id="shake_8h_html_a049b154b3d12b0df19b2c986f458341d"><div class="ttname"><a href="shake_8h.html#a049b154b3d12b0df19b2c986f458341d">SHAKE128_RATE</a></div><div class="ttdeci">#define SHAKE128_RATE</div><div class="ttdoc">The rate of the SHAKE-128 algorithm (i.e. </div><div class="ttdef"><b>Definition:</b> shake.h:44</div></div>
<div class="ttc" id="shake_8h_html_a8cd7a41f6f7efca80d063e7521f5b7fa"><div class="ttname"><a href="shake_8h.html#a8cd7a41f6f7efca80d063e7521f5b7fa">SHAKE256_RATE</a></div><div class="ttdeci">#define SHAKE256_RATE</div><div class="ttdoc">The rate of the SHAKE-256 algorithm (i.e. </div><div class="ttdef"><b>Definition:</b> shake.h:49</div></div>
<div class="ttc" id="shake_8h_html_a83ef76fe99fbb2423c1f6de3e794442c"><div class="ttname"><a href="shake_8h.html#a83ef76fe99fbb2423c1f6de3e794442c">shake_ctx</a></div><div class="ttdeci">Keccak_HashInstance shake_ctx</div><div class="ttdoc">The shake context (state) </div><div class="ttdef"><b>Definition:</b> shake.h:38</div></div>
<div class="ttc" id="shake_8h_html_a5d95194ec13b430cc983d86f62f6a782"><div class="ttname"><a href="shake_8h.html#a5d95194ec13b430cc983d86f62f6a782">shake128_squeezeblocks</a></div><div class="ttdeci">void shake128_squeezeblocks(shake_ctx *ctx, unsigned char *output, const size_t nr_blocks)</div><div class="ttdoc">Performs the squeeze step of the SHAKE-128 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:94</div></div>
<div class="ttc" id="shake_8h_html_aa5c39b537f89f69b2055de148f21e8b6"><div class="ttname"><a href="shake_8h.html#aa5c39b537f89f69b2055de148f21e8b6">cshake128_init</a></div><div class="ttdeci">void cshake128_init(cshake_ctx *ctx, const unsigned char *customization, const size_t customization_len)</div><div class="ttdoc">Performs the initialisation step of the cSHAKE-128 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:172</div></div>
<div class="ttc" id="shake_8h_html_a0acf5af5ab808883a94943eec7182ee1"><div class="ttname"><a href="shake_8h.html#a0acf5af5ab808883a94943eec7182ee1">cshake256</a></div><div class="ttdeci">void cshake256(unsigned char *output, size_t output_len, const unsigned char *input, const size_t input_len, const unsigned char *customization, const size_t customization_len)</div><div class="ttdoc">Performs the full cSHAKE-256 XOF to the given input. </div><div class="ttdef"><b>Definition:</b> shake.h:286</div></div>
<div class="ttc" id="shake_8h_html_ab45f1025ada0d380abc86034a04b0250"><div class="ttname"><a href="shake_8h.html#ab45f1025ada0d380abc86034a04b0250">cshake256_init</a></div><div class="ttdeci">void cshake256_init(cshake_ctx *ctx, const unsigned char *customization, const size_t customization_len)</div><div class="ttdoc">Performs the initialisation step of the cSHAKE-256 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:236</div></div>
<div class="ttc" id="shake_8h_html_a621bd1b10103c1ced7fa0fbd98dc4ba9"><div class="ttname"><a href="shake_8h.html#a621bd1b10103c1ced7fa0fbd98dc4ba9">shake256_absorb</a></div><div class="ttdeci">void shake256_absorb(shake_ctx *ctx, const unsigned char *input, const size_t input_len)</div><div class="ttdoc">Performs the absorb step of the SHAKE-256 XOF. </div><div class="ttdef"><b>Definition:</b> shake.h:129</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
